<!DOCTYPE html>
<html>
<head>
	<title>Excel App</title>
	
	<script src="https://code.datagridxl.com/datagridxl2.js"></script>
</head>
<body>
<script src="https://code.datagridxl.com/datagridxl2.js"></script>
<script>
var dark_theme = {

  "component"                 : "#15202b",
  
  // bottombar & topbar
  "button"                    : "#2f3b47",
  "button-icon"               : "#8899a6",
  "input"                     : "#15202b",
  "input|text"                : "#ffffff",
  "input|border"              : "#000000",
  "input:focus|border"        : "#0078ff",
  "input-info"                : "#8899a6",

  // contextmenu
  "contextmenu"               : "#15202b",
  "contextmenu|text"          : "#ffffff",
  "contextmenu-item:highlight": "#192734",
  "contextmenu-item-shortcut" : "#8899a6",


  "blanksheet"                : "#15202b",
  "sheet"                     : "#192734",
  "sheet|text"                : "#ffffff",

  // scrollbar
  "scrollbar"                 : "#000000",
  "scrollbar|border"          : "#444444",

  // grid lines
  "gridline"                  : "#ffffff",
  "gridline-tip"              : "#ffffff",
  "gridline|opacity"          : 0.10,

  // headers
  "header"                    : "#15202b",
  "header|text"               : "#ffffff",
  "header:highlight"          : "#192734",
  "header:selected"           : "#2a4157",
  "header:selected|text"      : "#ffffff",
  "header-icon"               : "#ecf5f4",

  // action ranges
  "cellrange:cut"             : "#0078ff",
  "cellrange:copy"            : "#0078ff",
  "cellrange:fill"            : "#ffffff",

  // selection
  "cellcursor"                : "#0078ff",
  "cellrange:selected"        : "#0078ff",
  "cellrange:selected|border" : "#0078ff",
  "cellrange:selected|opacity": 0.10,

  // fill handle
  "fillhandle"                : "#0078ff",

  // cell editor
  "celleditor"                : "#0078ff",

  // search
  "searchcursor"              : "#ecf5f4",
  "cell+found"                : "#abc5dc",
  "cell+found|opacity"        : 0.25,

  // freezeline
  "freezeline"                : "#2a4157",
  "freezeline-tip"            : "#2f5478",
  "freezelineplaceholder"     : "#2f5478",

  // move action
  "move?ghost"                : "#ffffff",
  "move?ghost|opacity"        : 0.1,
  "move?guide"                : "#8899a6",
  "move?guide|opacity"        : 0.5,

  // freeze action
  "freeze?hint"                : "#0078ff",
  "freeze?ghost"               : "#ffffff",
  "freeze?ghost|opacity"       : 0.1,
  "freeze?guide"               : "#8899a6",
  "freeze?guide|opacity"       : 0.5,

  // resize action
  "resize?hint"                : "#0078ff",
  "resize?guide"               : "#0078ff",
  "resize?guide|opacity"       : 1,

  // show action
  "show?hint"                  : "#15202b",
  "show?hint-icon"             : "#ffffff",
  "show?hint|border"           : "#0078ff"

};

var grid = new DataGridXL("grid", {
  theme: dark_theme
});
</script>
<style>
#grid, #chart {
  height: 300px;
}
</style>

<div id="chart"></div>
<div id="grid"></div>

<script src="https://code.datagridxl.com/datagridxl2.js"></script>
<!-- amCharts (chart plugin) -->
<script src="https://www.amcharts.com/lib/3/amcharts.js"></script>
<script src="https://www.amcharts.com/lib/3/serial.js"></script>
<script>
var my_data = [{
  "country": "USA",
  "visits": 2025,
  "votes": 400
}, {
  "country": "China",
  "visits": 1882,
  "votes": 400
}, {
  "country": "Japan",
  "visits": 1809,
  "votes": 400
}, {
  "country": "Germany",
  "visits": 1422,
  "votes": 400
}, {
  "country": "India",
  "visits": 1522,
  "votes": 500
}, {
  "country": "Netherlands",
  "visits": 1542,
  "votes": 500
}];

var grid;
var chart;

createGrid();
createChart();

function createGrid(){

  grid = new DataGridXL("grid", {
    data: my_data,
    allowDeleteCols: false,
    allowInsertCols: false,
    allowFillCells: true,
    fillCellsDirection: "y",
    expandSheetOnPaste: false,
    allowFreezeCols: false,
    allowFreezeRows: false,
    allowMoveCols: false
  });

  function updateChartData(){

    var gridInstance = this;

    chart.dataProvider = gridInstance.getData();
    chart.validateData();
    chart.animateAgain();

  }

  grid.events.on("setcellvalues", updateChartData);
  grid.events.on("moverows", updateChartData);
  grid.events.on("sort", updateChartData);
  grid.events.on("deleterows", updateChartData);
  grid.events.on("insertrows", updateChartData);

}

function createChart(){

  chart = AmCharts.makeChart( "chart", {
    "type": "serial",
    "theme": "none",
    "dataProvider": my_data,
    "categoryField": "country",
    "startDuration": 1,
    "graphs": [ {
      "balloonText": "[[category]]: [[value]]",
      "fillAlphas": 0.8,
      "lineAlpha": 0.2,
      "type": "column",
      "valueField": "visits",
      "fillColors": "pink",
      "lineColor": "pink"
    }, {
      "balloonText": "[[category]]: [[value]]",
      "fillAlphas": 0.8,
      "lineAlpha": 0.2,
      "type": "column",
      "valueField": "votes",
      "fillColors": "purple",
      "lineColor": "purple"
    } ],
    "chartCursor": {
      "categoryBalloonEnabled": false,
      "cursorAlpha": 0,
      "zoomable": false
    }
  } );

}

</script>
	<div id="grid" style="width:100%;height:400px;"></div>
	<script>
		var options = {
			data: [
				[1, 2, 3, 4, 5, 6, 7, 8, 9, 10, , , , , , , , , , , , , , , , , , ,],
				[11, 12, , , , , , , , , , , , , , , , , , , , , , , , , , ,],
				[21, 22, 23, , , , , , , , , , , , , , , , , , , , , , , , , ,],
				[, , , , , , , , , , , , , , , , , , , , , , , , , , , ,],
				[, , , , , , , , , , , , , , , , , , , , , , , , , , , ,],
				[, , , , , , , , , , , , , , , , , , , , , , , , , , , ,],
				[, , , , , , , , , , , , , , , , , , , , , , , , , , , ,],
			]
		};
		var grid = new DataGridXL("grid", options);
	</script>
<style>
#grid {
  height: 400px;
}
</style>

<div id="grid"></div>

<style>
#grid {
  height: 400px;
}
</style>

<div id="grid"></div>
</body>
</html>
