<!DOCTYPE html>
<html>
<head>
	<title>Excel App</title>
	
	<script src="https://code.datagridxl.com/datagridxl2.js"></script>
</head>
<body>
<script src="https://code.datagridxl.com/datagridxl2.js"></script>
<style>
#grid {
  height: 400px;
}

#toolbar {
  background: var(--tableodd);
  margin-bottom: 12px;
  padding: 8px;

  display: flex;
  justify-content: space-between;
}
</style>

<div id="toolbar" class="dgxl-app">
  <div>
    <input type="file" id="csv-file" name="files-csv" class="custom-file-input" accept=".csv"><label for="csv-file">Browse…</label>
  </div>
  <div>
    <button class="button" id="button-save">Save</button>
  </div>
</div>

<div id="grid"></div>

<script src="https://code.datagridxl.com/datagridxl2.js"></script>
<!-- Papa Parse (to import and parse CSV files) -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.3.1/papaparse.min.js"></script>
<script>
var csvFile = document.getElementById("csv-file");

// create empty grid
var grid = new DataGridXL("grid", {
  data: DataGridXL.createEmptyData(20,20)
});

csvFile.onchange = function(e){
  var file = e.target.files[0];

    Papa.parse(file, {
      header: true,
      dynamicTyping: true,
      complete: function(results) {

        // overwrite grid with new data

        grid = new DataGridXL("grid", {
          data: results.data
        });

      }
    });

}

document.getElementById("button-save").onclick = function(){
  grid.downloadDataAsCSV();
}
</script>
<script>
var dark_theme = {

  "component"                 : "#15202b",
  
  // bottombar & topbar
  "button"                    : "#2f3b47",
  "button-icon"               : "#8899a6",
  "input"                     : "#15202b",
  "input|text"                : "#ffffff",
  "input|border"              : "#000000",
  "input:focus|border"        : "#0078ff",
  "input-info"                : "#8899a6",

  // contextmenu
  "contextmenu"               : "#15202b",
  "contextmenu|text"          : "#ffffff",
  "contextmenu-item:highlight": "#192734",
  "contextmenu-item-shortcut" : "#8899a6",


  "blanksheet"                : "#15202b",
  "sheet"                     : "#192734",
  "sheet|text"                : "#ffffff",

  // scrollbar
  "scrollbar"                 : "#000000",
  "scrollbar|border"          : "#444444",

  // grid lines
  "gridline"                  : "#ffffff",
  "gridline-tip"              : "#ffffff",
  "gridline|opacity"          : 0.10,

  // headers
  "header"                    : "#15202b",
  "header|text"               : "#ffffff",
  "header:highlight"          : "#192734",
  "header:selected"           : "#2a4157",
  "header:selected|text"      : "#ffffff",
  "header-icon"               : "#ecf5f4",

  // action ranges
  "cellrange:cut"             : "#0078ff",
  "cellrange:copy"            : "#0078ff",
  "cellrange:fill"            : "#ffffff",

  // selection
  "cellcursor"                : "#0078ff",
  "cellrange:selected"        : "#0078ff",
  "cellrange:selected|border" : "#0078ff",
  "cellrange:selected|opacity": 0.10,

  // fill handle
  "fillhandle"                : "#0078ff",

  // cell editor
  "celleditor"                : "#0078ff",

  // search
  "searchcursor"              : "#ecf5f4",
  "cell+found"                : "#abc5dc",
  "cell+found|opacity"        : 0.25,

  // freezeline
  "freezeline"                : "#2a4157",
  "freezeline-tip"            : "#2f5478",
  "freezelineplaceholder"     : "#2f5478",

  // move action
  "move?ghost"                : "#ffffff",
  "move?ghost|opacity"        : 0.1,
  "move?guide"                : "#8899a6",
  "move?guide|opacity"        : 0.5,

  // freeze action
  "freeze?hint"                : "#0078ff",
  "freeze?ghost"               : "#ffffff",
  "freeze?ghost|opacity"       : 0.1,
  "freeze?guide"               : "#8899a6",
  "freeze?guide|opacity"       : 0.5,

  // resize action
  "resize?hint"                : "#0078ff",
  "resize?guide"               : "#0078ff",
  "resize?guide|opacity"       : 1,

  // show action
  "show?hint"                  : "#15202b",
  "show?hint-icon"             : "#ffffff",
  "show?hint|border"           : "#0078ff"

};

var grid = new DataGridXL("grid", {
  theme: dark_theme
});
</script>
<style>
#grid {
  height: 400px;
  border: 1px solid grey;
}
</style>

<div id="grid"></div>

<script src="https://code.datagridxl.com/datagridxl2.js"></script>
<script>
var grid = new DataGridXL("grid", {
  data: DataGridXL.createDummyData(2000,500)
});
</script>
	<div id="grid" style="width:100%;height:400px;"></div>
	<script>
		var options = {
			data: [
				[1, 2, 3, 4, 5, 6, 7, 8, 9, 10, , , , , , , , , , , , , , , , , , ,],
				[11, 12, , , , , , , , , , , , , , , , , , , , , , , , , , ,],
				[21, 22, 23, , , , , , , , , , , , , , , , , , , , , , , , , ,],
				[, , , , , , , , , , , , , , , , , , , , , , , , , , , ,],
				[, , , , , , , , , , , , , , , , , , , , , , , , , , , ,],
				[, , , , , , , , , , , , , , , , , , , , , , , , , , , ,],
				[, , , , , , , , , , , , , , , , , , , , , , , , , , , ,],
			]
		};
		var grid = new DataGridXL("grid", options);
	</script>
<style>
#grid, #chart {
  height: 300px;
}
</style>

<div id="chart"></div>
<div id="grid"></div>

<script src="https://code.datagridxl.com/datagridxl2.js"></script>
<!-- amCharts (chart plugin) -->
<script src="https://www.amcharts.com/lib/3/amcharts.js"></script>
<script src="https://www.amcharts.com/lib/3/serial.js"></script>
<script>
var my_data = [{
  "empresa": "Marcopolo",
  "ano": 2021,
  "vendas": 800
}, {
  "setor": "Autopeças",
  "ano": 2021,
  "vendas": 650
}, {
  "empresa": "Exterior",
  "ano": 2021,
  "vendas": 600
}, {
  "empresa": "Outros",
  "ano": 2021,
  "vendas": 356
}, {
];

var grid;
var chart;

createGrid();
createChart();

function createGrid(){

  grid = new DataGridXL("grid", {
    data: my_data,
    allowDeleteCols: false,
    allowInsertCols: false,
    allowFillCells: true,
    fillCellsDirection: "y",
    expandSheetOnPaste: false,
    allowFreezeCols: false,
    allowFreezeRows: false,
    allowMoveCols: false
  });

  function updateChartData(){

    var gridInstance = this;

    chart.dataProvider = gridInstance.getData();
    chart.validateData();
    chart.animateAgain();

  }

  grid.events.on("setcellvalues", updateChartData);
  grid.events.on("moverows", updateChartData);
  grid.events.on("sort", updateChartData);
  grid.events.on("deleterows", updateChartData);
  grid.events.on("insertrows", updateChartData);

}

function createChart(){

  chart = AmCharts.makeChart( "Gráfico", {
    "type": "serial",
    "theme": "none",
    "dataProvider": my_data,
    "categoryField": "Desempenho",
    "startDuration": 1,
    "graphs": [ {
      "balloonText": "[[category]]: [[value]]",
      "fillAlphas": 0.8,
      "lineAlpha": 0.2,
      "type": "column",
      "valueField": "Vendas",
      "fillColors": "pink",
      "lineColor": "pink"
    }, {
      "balloonText": "[[category]]: [[value]]",
      "fillAlphas": 0.8,
      "lineAlpha": 0.2,
      "type": "column",
      "valueField": "Produtos",
      "fillColors": "purple",
      "lineColor": "purple"
    } ],
    "chartCursor": {
      "categoryBalloonEnabled": false,
      "cursorAlpha": 0,
      "zoomable": false
    }
  } );

}

</script>
<style>
#grid {
  height: 400px;
}
</style>

<div id="grid"></div>

<style>
#grid {
  height: 400px;
}
</style>

<div id="grid"></div>
</body>
</html>
